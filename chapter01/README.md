# 1.1 초난감DAO

> 자바빈이란?

- 원래 비주얼 툴에서 조작 가능한 컴포넌트를 말함.
- 웹 기반으로 바뀌면서 그대로 명맥을 유지
- 다음 두가지 관례를 따르는 것을 자바빈이라고 함.
  - 디폴트 생성자: 툴이나 프레임워크에서 리플렉션 이용해서 오브젝트를 생성하기 때문
  - 프로퍼티

> **스프링을 공부한다는 것은?**

- 이 간단한 메소드를 이미 검증을 했다.
- 잘 동작하는 코드를 굳이 수정하고 개선하는 이유는 무엇일까?
- 이 코드를 개선했을때의 장점은 무엇일까?
- 그런 장점들이 당장에, 또는 미래에 주는 유익은 무엇인가?
- 객체지향 설계의 원칙과는 무슨 상관이 있을까?
- 이 코드를 개선하는 경우와 그대로 사용하는 경우 스프링을 사용하는 개발에서 무슨 차이가 있을까?

# 1.2 DAO 의 분리

## 디자인 패턴

### 템플릿 메소드 패턴

```java
public abstract class Super {

  public void templateMethod() {
    // 기본 알고리즘 코드
    hookMethod();
    abstractMethod();
		...
  }

  protected void hookMethod() {} // -> 선택적으로 오버라이드 가능한 훅메소드
  public abstract void abstractMethod(); // -> 서브클래스에서 반드시 구현해야하는 추상메소드

}

public class Sub1 extends Super {

  @Override
  protected void hookMethod() {
		...
  }

  @Override
  public void abstractMethod() {
		...
  }
}
```
변하지 않는 기능은 슈퍼클래스에 만들어두고 선택적으로 오버라이드할 수 있는 메소드를 만들어두는 것을 템플릿 메소드 패턴이라고 한다.

### 팩토리 메소드 패턴

객체 생성에 대한 책임을 하위 클래스에 떠넘기는 것을 말한다.
```java
public abstract class Sub2 extends Super {

  public abstract FooInterface factoryMethod();
}
```
이때 Sub2 의 관심은 FooInterface 가 어떤 구현 객체인지 전혀 관심이 없다는 것이다.

참고로 객체를 생성하는 기능을 가진 메소드를 팩토리 메소드라고 하는데 패턴과는 혼동하지않도록 주의해야한다.

# 1.3 DAO의 확장

## 1.3.4 원칙과 패턴

### 개방 폐쇄 원칙

클래스나 모듈은 확장에는 열려 있어야 하고 변경에는 닫혀있어야한다.

UserDao는 DB 연결 방법이라는 기능을 확장하는데에는 열려있고, 동시에 UserDao 자신의 핵심 기능을 구현한 코드는 그런 변화에 영향을 받지 않고 유지할 수 있으므로 변경에는 닫혀 있다.

### 전략 패턴

전략 패턴은 자신의 기능 맥락에서 필요에 따라 변경이 필요한 알고리즘을 인터페이스를 통해 통째로 외부로 분리시킨다. 전략 패턴에서 전략은 대체 가능한 전략을 말한다. 그래서 전략 패턴이다.

UserDaoTest-UserDao-ConnectionMaker 구조에서 UserDao 는 전략 패턴의 컨텍스트에 해당한다. DB 연결방식이라는 알고리즘을 ConnectionMaker 라는 인터페이스로 정의하고 이 전략을 바꿔가면서 사용하도록 분리했다. 전략패턴에서 클라이언트(UserDaoTest)는 컨텍스트가 사용할 전략을 컨텍스트의 생성자 등을 통해 제공해주는 것이 일반적이다.

**스프링이란 바로 지금까지 설명한 객체지향적 설계 원칙과 디자인 패턴에 나타난 자엊ㅁ을 자연스럽게 개발자들이 활용할 수 있게 해주는 프레임워크다**

# 1.4 ...
IoC 는 프레임워크에만 종속된 또는 스프링에만 종속된 패턴이 아니다. 널리 쓰이는 프로그래밍 기법이다. IoC 를 구현하면 코드의 확장성과 유연성이 증가한다.

예를 들면, UserDao 의 첫번째 모델은 직접 ConnectionMaker 의 구현체를 선택해서 능동적으로 행동하는 객체였다. 하지만 DaoFactory 가 생기면서 ConnectionMaker 를 수동적을 주입받아 사용되어지게 됐다.

# 1.5 스프링의 IoC

- DaoFactory 를 스프링으로 써보는 장
- 스프링에서는 빈 팩토리, 어플리케이션 컨텍스트라는 용어를 사용
  - 빈 팩토라: 빈을 생성하고 관계를 설정하는 IoC의 기본 기능에 초점을 맞춤 용어
  - 어플리케이션 컨텍스트: 어플리케이션 전반에 걸쳐 모든 구성요소의 제어 작업을 담당하는 IoC 엔진이라는 의미에 초점을 맞춤 용어

마치 건물이 설계도면을 따라서 만들어지듯이, 애플리케이션도 어플리ㅔ이션 컨텍스트와 그 설정정보를 따라서 만들어지고 구성된다고 생각하 수 있다.

## 어플리이션 컨텍스트가 DaoFactory 를 오브젝트 팩토리로 사용한 것에 비해 얻을 수 있는 장점

1. 클라이언트는 구체적인 팩토리 클래스를 알 필요가 없다.

필요할 때마다 특정 팩토리 클래스를 생성해서 가져와야할 필요가 없다.   
오브젝트 팩토리가 아무리 많아져도 알 필요가 없다.

2. 어플리케이션 컨텍스트는 종합 IoC 서비스를 제공한다.

단순 오브 젝트 생성과 관계설정뿐만 아니라, 만들어지는 방식, 시점과 전략을 다르게할 수 있고 자동생성, 오브젝트에 대한 후처리, 정보의 조합, 설정방식의 다변화, 인터셉팅 등 다양하게 활용할 수 있는 기능을 제공한다. 또, 빈이 사용할 수 있는 기반기술 서비스나 외부 시스템과의 연동 등을 컨테이너 차원에서 제공해주기도 한다.

3. 어플리케이션 컨텍스트는 빈을 검색하는 다양한 방법을 제공한다.
